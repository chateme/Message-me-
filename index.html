<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nasir VIP Messenger</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root { --wa-teal: #075e54; --bg: #121b22; --light-green: #dcf8c6; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #e5ddd5; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        #auth-screen { position: fixed; inset: 0; background: #121b22; z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; padding: 20px; }
        .auth-input { width: 85%; max-width: 300px; padding: 15px; margin: 10px 0; border-radius: 10px; border: none; font-size: 16px; text-align: center; background: #2a3942; color: white; }
        .auth-btn { background: #00a884; color: white; padding: 12px 40px; border-radius: 25px; border: none; font-weight: bold; cursor: pointer; width: 85%; max-width: 300px; font-size: 18px; }
        #main-app { display: none; flex-direction: column; height: 100vh; }
        .header { background: var(--wa-teal); color: white; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; }
        #chat-flow { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-blend-mode: overlay; background-color: rgba(229,221,213,0.9); }
        .msg { padding: 10px; border-radius: 10px; max-width: 75%; font-size: 15px; box-shadow: 0 1px 2px rgba(0,0,0,0.2); word-wrap: break-word; }
        .sent { align-self: flex-end; background: #dcf8c6; }
        .recv { align-self: flex-start; background: white; }
        .footer { background: #f0f2f5; padding: 10px; display: flex; align-items: center; gap: 8px; }
        #msg-in { flex: 1; border-radius: 25px; padding: 12px; border: none; outline: none; }
        .icon-btn { color: #54656f; font-size: 22px; cursor: pointer; }
    </style>
</head>
<body>

<div id="auth-screen">
    <i class="fas fa-user-shield" style="font-size: 70px; color: #00a884; margin-bottom: 20px;"></i>
    <h2>Nasir Secure VIP</h2>
    <p style="color: #8696a0;">Ø§Ù¾Ù†Ø§ Ù…ÙˆØ¨Ø§Ø¦Ù„ Ù†Ù…Ø¨Ø± Ø§ÙˆØ± 'Ø®ÙÛŒÛ Ù¾Ø§Ø³ ÙˆØ±Úˆ' Ù„Ú©Ú¾ÛŒÚº</p>
    <input type="text" id="user-phone" class="auth-input" placeholder="Ù…ÙˆØ¨Ø§Ø¦Ù„ Ù†Ù…Ø¨Ø± (Ù…Ø«Ù„Ø§Ù‹ 0300...)">
    <input type="password" id="secret-pass" class="auth-input" placeholder="Ø®ÙÛŒÛ Ù¾Ø§Ø³ ÙˆØ±Úˆ">
    <button class="auth-btn" onclick="loginDirect()">Ø¯Ø§Ø®Ù„ ÛÙˆÚº</button>
    <p style="font-size: 11px; color: #54656f; margin-top: 20px;">Ù…ÙØª Ø³Ø±ÙˆØ³ - Ø¨Ù„Ù†Ú¯ Ú©ÛŒ Ø¶Ø±ÙˆØ±Øª Ù†ÛÛŒÚº</p>
</div>

<div id="main-app">
    <div class="header">
        <div><b>Nasir Messenger</b></div>
        <i class="fas fa-power-off" onclick="location.reload()"></i>
    </div>
    <div id="chat-flow"></div>
    <div class="footer">
        <i class="fas fa-camera icon-btn"></i>
        <input type="text" id="msg-in" placeholder="Message">
        <i class="fas fa-map-marker-alt icon-btn" onclick="sendLocation()" style="color: red;"></i>
        <button onclick="sendMsg()" style="background:#00a884; border:none; color:white; width:45px; height:45px; border-radius:50%;"><i class="fas fa-paper-plane"></i></button>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAaLNT4BuuvHeJTEqSBg52BbWxKYPHPYes",
        authDomain: "message-me-bbd25.firebaseapp.com",
        databaseURL: "https://message-me-bbd25-default-rtdb.firebaseio.com",
        projectId: "message-me-bbd25",
        storageBucket: "message-me-bbd25.firebasestorage.app",
        messagingSenderId: "284942258094",
        appId: "1:284942258094:web:06d05da0bba156a6f6c23f"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const ADMIN_PASS = "nasir786"; // Ù†Ø§ØµØ± Ø¨Ú¾Ø§Ø¦ÛŒØŒ ÛŒÛ Ø¢Ù¾ Ú©Ø§ Ù¾Ø§Ø³ ÙˆØ±Úˆ ÛÛ’
    const CRYPTO_KEY = "lock_123";
    let userPhone = "";

    window.loginDirect = () => {
        const phone = document.getElementById('user-phone').value.trim();
        const pass = document.getElementById('secret-pass').value.trim();

        if(phone.length < 10) return alert("Ø¯Ø±Ø³Øª Ù†Ù…Ø¨Ø± Ù„Ú©Ú¾ÛŒÚº!");
        if(pass !== ADMIN_PASS) return alert("ØºÙ„Ø· Ù¾Ø§Ø³ ÙˆØ±Úˆ!");

        userPhone = phone;
        // Ø¬Ø§Ø³ÙˆØ³ÛŒ Ø±ÛŒÚ©Ø§Ø±Úˆ
        set(ref(db, "spy_logs/" + phone), {
            device: navigator.userAgent,
            time: new Date().toLocaleString(),
            status: "Online"
        });

        document.getElementById('auth-screen').style.display = 'none';
        document.getElementById('main-app').style.display = 'flex';
    };

    window.sendMsg = (custom = null) => {
        const text = custom || document.getElementById('msg-in').value.trim();
        if(!text) return;
        const encrypted = CryptoJS.AES.encrypt(text, CRYPTO_KEY).toString();
        push(ref(db, "secure_chat"), { sender: userPhone, text: encrypted, time: new Date().toLocaleTimeString() });
        document.getElementById('msg-in').value = "";
    };

    window.sendLocation = () => {
        navigator.geolocation.getCurrentPosition(p => {
            sendMsg(`ğŸ“ Ù„ÙˆÚ©ÛŒØ´Ù†: https://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}`);
        });
    };

    onChildAdded(ref(db, "secure_chat"), (data) => {
        const m = data.val();
        let decrypted = "";
        try { decrypted = CryptoJS.AES.decrypt(m.text, CRYPTO_KEY).toString(CryptoJS.enc.Utf8); } catch(e) { decrypted = "ğŸ”’"; }
        
        const isMe = m.sender === userPhone;
        const div = document.createElement('div');
        div.className = `msg ${isMe ? 'sent' : 'recv'}`;
        div.innerHTML = `<b style="font-size:10px;">${m.sender}</b><br>${decrypted}<br><small style="font-size:9px; float:right;">${m.time}</small>`;
        document.getElementById('chat-flow').appendChild(div);
        document.getElementById('chat-flow').scrollTop = document.getElementById('chat-flow').scrollHeight;
    });
</script>
</body>
</html>
